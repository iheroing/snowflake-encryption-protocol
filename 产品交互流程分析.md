# 雪花密语 - 产品交互流程分析

## 🤔 核心问题

### 当前的困惑
1. **密码保护有什么作用？**
   - 创建时可以设置密码
   - 但查看时直接显示明文
   - 密码似乎没有实际作用

2. **交互流程不清晰**
   - 用户不知道密码保护的意义
   - 60秒倒计时和画廊保存的关系模糊
   - "阅后即焚"和"永久保存"的矛盾

---

## 📊 当前流程分析

### 流程 1：无密码创建
```
1. 输入心语
2. 选择精华类型
3. 点击"凝结心语"
4. 进入查看页面（60秒倒计时）
5. 60秒后融化
6. 心语保存在画廊（明文）
```

**问题**：
- ❌ 60秒后"融化"但实际保存了
- ❌ "阅后即焚"的概念被破坏
- ❌ 画廊里可以随时查看

### 流程 2：有密码创建
```
1. 输入心语
2. 选择精华类型
3. 启用密码保护
4. 输入密码
5. 点击"凝结心语"
6. 进入查看页面（60秒倒计时）
7. 60秒后融化
8. 心语保存在画廊（加密）
```

**问题**：
- ❌ 创建时输入密码，但查看时不需要密码
- ❌ 密码保护没有实际作用
- ❌ 画廊里点击加密心语，需要密码才能查看
- ❌ 但刚创建完就能直接看，逻辑矛盾

---

## 💡 核心概念重新定义

### 雪花密语的本质

**两种使用场景**：

#### 场景 A：临时分享（阅后即焚）
- **目的**：发送一次性消息
- **特点**：60秒后消失，不保存
- **用例**：秘密约定、临时密码、惊喜消息

#### 场景 B：私密日记（加密保存）
- **目的**：记录私密想法
- **特点**：加密保存，需要密码查看
- **用例**：日记、秘密、重要信息

---

## 🎯 重新设计的交互流程

### 方案 1：明确区分两种模式

#### 模式 A：阅后即焚模式
```
创建页面：
├─ 输入心语
├─ 选择精华
├─ [开关] 阅后即焚模式 ✓
└─ 凝结心语

查看页面：
├─ 显示雪花 + 心语
├─ 60秒倒计时
├─ 可以截图/分享
├─ 60秒后融化
└─ ❌ 不保存到画廊

结果：
└─ 心语永久消失
```

#### 模式 B：加密保存模式
```
创建页面：
├─ 输入心语
├─ 选择精华
├─ [开关] 阅后即焚模式 ✗
├─ [开关] 密码保护 ✓
├─ 输入密码
└─ 凝结心语

查看页面：
├─ 显示雪花 + 心语（明文）
├─ 60秒倒计时（仅为仪式感）
├─ 可以截图/分享
├─ 60秒后"融化"（视觉效果）
└─ ✓ 保存到画廊（加密）

画廊查看：
├─ 点击加密心语
├─ 输入密码
├─ 解密成功
└─ 显示内容
```

### 方案 2：简化为单一流程

#### 统一流程
```
创建页面：
├─ 输入心语
├─ 选择精华
├─ [选择] 保存方式：
│   ├─ 临时查看（不保存）
│   ├─ 明文保存（画廊可见）
│   └─ 加密保存（需要密码）
└─ 凝结心语

查看页面：
├─ 显示雪花 + 心语
├─ 60秒倒计时
├─ 可以截图/分享
└─ 60秒后：
    ├─ 临时查看 → 永久消失
    ├─ 明文保存 → 保存到画廊
    └─ 加密保存 → 加密后保存

画廊：
├─ 明文心语 → 直接查看
└─ 加密心语 → 输入密码查看
```

---

## 🎨 推荐方案：方案 2（简化版）

### 为什么选择方案 2？

1. **清晰的选择**
   - 用户明确知道心语的去向
   - 三种保存方式对应三种需求

2. **密码保护有意义**
   - 只在"加密保存"时需要密码
   - 画廊查看时需要密码
   - 逻辑一致

3. **60秒倒计时的意义**
   - 临时查看：真正的倒计时
   - 保存模式：仪式感 + 最后确认

---

## 🔧 具体实现方案

### 1. 创建页面改进

#### UI 设计
```
┌─────────────────────────────────────┐
│  写下你的心语...                    │
│  [文本输入框]                       │
│                                     │
│  选择精华：                         │
│  ○ 极光之息  ○ 星尘之梦            │
│                                     │
│  保存方式：                         │
│  ┌─────────────────────────────┐   │
│  │ ○ 临时查看                  │   │
│  │   60秒后永久消失            │   │
│  ├─────────────────────────────┤   │
│  │ ○ 明文保存                  │   │
│  │   保存到画廊，随时可查看    │   │
│  ├─────────────────────────────┤   │
│  │ ● 加密保存                  │   │
│  │   需要密码才能查看          │   │
│  │   [密码输入框]              │   │
│  │   [确认密码]                │   │
│  └─────────────────────────────┘   │
│                                     │
│  [凝结心语]                         │
└─────────────────────────────────────┘
```

#### 代码结构
```typescript
enum SaveMode {
  TEMPORARY = 'temporary',  // 临时查看
  PLAIN = 'plain',          // 明文保存
  ENCRYPTED = 'encrypted'   // 加密保存
}

const [saveMode, setSaveMode] = useState<SaveMode>(SaveMode.PLAIN);
const [password, setPassword] = useState("");
```

### 2. 查看页面改进

#### 临时查看模式
```
┌─────────────────────────────────────┐
│  ⚠️ 临时查看模式                    │
│  这条心语将在 60 秒后永久消失       │
│                                     │
│  [雪花图案]                         │
│  "你的心语内容"                     │
│                                     │
│  倒计时：45 秒                      │
│                                     │
│  [截图保存] [分享]                  │
│  ❌ 不会保存到画廊                  │
└─────────────────────────────────────┘
```

#### 保存模式
```
┌─────────────────────────────────────┐
│  ✓ 已保存到画廊                     │
│  60秒后可以在画廊中查看             │
│                                     │
│  [雪花图案]                         │
│  "你的心语内容"                     │
│                                     │
│  倒计时：45 秒                      │
│                                     │
│  [截图保存] [分享] [前往画廊]       │
└─────────────────────────────────────┘
```

### 3. 画廊改进

#### 心语卡片
```
┌─────────────────────────┐
│  🔓 明文心语            │
│  [雪花预览]             │
│  "心语内容预览..."      │
│  2小时前                │
│  [查看] [删除]          │
└─────────────────────────┘

┌─────────────────────────┐
│  🔒 加密心语            │
│  [雪花预览]             │
│  "***************"      │
│  2小时前                │
│  [解密查看] [删除]      │
└─────────────────────────┘
```

---

## 📋 用户故事

### 故事 1：临时分享秘密
```
小明想告诉小红一个秘密约定地点，但不想留下记录。

1. 小明创建心语："晚上8点，老地方见"
2. 选择"临时查看"模式
3. 截图发给小红
4. 小红看到后，60秒后心语消失
5. 没有任何记录留下

✓ 真正的阅后即焚
```

### 故事 2：私密日记
```
小红想记录今天的心情，但不想被别人看到。

1. 小红创建心语："今天遇到了喜欢的人"
2. 选择"加密保存"模式
3. 设置密码："mySecret123"
4. 心语保存到画廊（加密）
5. 下次查看时需要输入密码

✓ 真正的隐私保护
```

### 故事 3：美好回忆
```
小明想记录和女朋友的纪念日。

1. 小明创建心语："2026.01.18 - 我们在一起的第100天"
2. 选择"明文保存"模式
3. 心语保存到画廊
4. 随时可以查看回忆

✓ 方便的记录工具
```

---

## 🎯 实现优先级

### Phase 1：核心功能修复（必须）
1. ✅ 修改创建页面，添加保存方式选择
2. ✅ 实现临时查看模式（不保存）
3. ✅ 修复密码保护逻辑（创建时加密，查看时解密）
4. ✅ 更新查看页面提示文字

### Phase 2：体验优化（重要）
1. ⭐ 优化 UI 设计，让选择更清晰
2. ⭐ 添加引导提示，解释三种模式
3. ⭐ 改进画廊显示，区分明文和加密
4. ⭐ 添加"前往画廊"快捷按钮

### Phase 3：高级功能（可选）
1. 💡 分享功能增强（生成链接）
2. 💡 密码强度提示
3. 💡 密码找回机制（安全问题）
4. 💡 批量管理功能

---

## 🔄 对比：修改前后

### 修改前
```
创建 → 查看（60秒） → 画廊保存
         ↓
      密码？（没用）
```

**问题**：
- 密码保护没有意义
- 阅后即焚是假的
- 用户困惑

### 修改后
```
创建 → 选择模式 → 查看（60秒） → 结果
       ├─ 临时    → 不保存      → 消失
       ├─ 明文    → 明文保存    → 画廊（明文）
       └─ 加密    → 加密保存    → 画廊（加密）
                                    ↓
                                 需要密码
```

**优势**：
- ✅ 逻辑清晰
- ✅ 密码有意义
- ✅ 真正的阅后即焚
- ✅ 用户可控

---

## 💬 用户引导文案

### 创建页面
```
💡 提示：选择保存方式

• 临时查看：60秒后永久消失，适合一次性消息
• 明文保存：保存到画廊，随时可查看
• 加密保存：需要密码才能查看，保护隐私
```

### 查看页面（临时模式）
```
⚠️ 临时查看模式

这条心语将在 60 秒后永久消失。
如果想保留，请立即截图保存。

倒计时：45 秒
```

### 查看页面（保存模式）
```
✓ 已保存到画廊

这条心语已保存，60秒后可以在画廊中查看。
你可以随时回来欣赏这片雪花。

倒计时：45 秒（仅为仪式感）
```

---

## 🎨 视觉设计建议

### 保存方式选择器
```
┌─────────────────────────────────────┐
│  保存方式                           │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🔥 临时查看                   │ │
│  │ 60秒后永久消失                │ │
│  │ 适合：秘密约定、临时密码      │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 📖 明文保存                   │ │
│  │ 保存到画廊，随时可查看        │ │
│  │ 适合：美好回忆、纪念日        │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 🔒 加密保存                   │ │
│  │ 需要密码才能查看              │ │
│  │ 适合：私密日记、秘密          │ │
│  │ [密码输入框]                  │ │
│  └───────────────────────────────┘ │
└─────────────────────────────────────┘
```

---

## 📊 数据流程

### 临时查看
```
输入 → 生成雪花 → 显示60秒 → 销毁
                              ↓
                           不保存
```

### 明文保存
```
输入 → 生成雪花 → 显示60秒 → 保存
                              ↓
                        localStorage
                        (明文存储)
                              ↓
                           画廊显示
```

### 加密保存
```
输入 + 密码 → 加密 → 生成雪花 → 显示60秒 → 保存
                                            ↓
                                      localStorage
                                      (加密存储)
                                            ↓
                                         画廊显示
                                         (需要密码)
```

---

## ✅ 实施建议

### 立即实施
1. **修改 EncryptView**
   - 添加保存方式选择器
   - 只在加密模式显示密码输入

2. **修改 DecryptView**
   - 根据保存方式显示不同提示
   - 临时模式：强调"即将消失"
   - 保存模式：显示"已保存"

3. **修改 saveSnowflake**
   - 添加 saveMode 参数
   - 临时模式不调用保存函数

4. **修改 GalleryView**
   - 区分明文和加密心语
   - 加密心语显示锁图标和遮罩

### 测试要点
- [ ] 临时模式不保存到画廊
- [ ] 明文模式直接保存
- [ ] 加密模式需要密码
- [ ] 画廊查看加密心语需要密码
- [ ] 密码错误提示正确

---

**这样的流程是否更清晰？需要我开始实现吗？** 🤔
